# ã‚³ãƒ¡ãƒ³ãƒˆã¨ãƒ­ã‚°è¡¨ç¤ºå½¢å¼ã®æ¨™æº–åŒ–

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã€AskAI ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã§çµ±ä¸€ã•ã‚ŒãŸã‚³ãƒ¡ãƒ³ãƒˆã¨ãƒ­ã‚°è¡¨ç¤ºå½¢å¼ã®æ¨™æº–ã«ã¤ã„ã¦èª¬æ˜ã—ã¾ã™ã€‚

## æ¦‚è¦

ã™ã¹ã¦ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã€ä»¥ä¸‹ã®ç‚¹ãŒçµ±ä¸€ã•ã‚Œã¦ã„ã¾ã™ï¼š

1. **æ—¥æœ¬èªã‚³ãƒ¡ãƒ³ãƒˆã®ä¸€è²«æ€§**: ã™ã¹ã¦ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ UTF-8 ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¨çµ±ä¸€ã•ã‚ŒãŸæ—¥æœ¬èªè¡¨ç¾ã‚’ä½¿ç”¨
2. **ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å½¢å¼**: çµµæ–‡å­—ã¨è¨˜å·ã‚’ä½¿ç”¨ã—ãŸè¦–èªæ€§ã®é«˜ã„ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
3. **ãƒ•ã‚§ãƒ¼ã‚ºåŒºåˆ‡ã‚Šã®çµ±ä¸€**: ã™ã¹ã¦ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã§åŒã˜åŒºåˆ‡ã‚Šè¨˜å·ã‚’ä½¿ç”¨
4. **æ§‹é€ åŒ–ãƒ­ã‚®ãƒ³ã‚°**: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ãŸãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å¯èƒ½ãªãƒ­ã‚°

## ãƒ•ã‚§ãƒ¼ã‚ºåŒºåˆ‡ã‚Šã®æ¨™æº–å½¢å¼

### ãƒ•ã‚§ãƒ¼ã‚ºã®é–‹å§‹ã¨çµ‚äº†

```csharp
// ãƒ•ã‚§ãƒ¼ã‚ºé–‹å§‹
logger.LogInformation("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
logger.LogInformation("ãƒ•ã‚§ãƒ¼ã‚º 1: ãƒ«ãƒ¼ã‚¿ãƒ¼ãŒå¿…è¦ãªå°‚é–€å®¶ã‚’é¸æŠœ");
logger.LogInformation("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");

// ãƒ•ã‚§ãƒ¼ã‚ºçµ‚äº†ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
logger.LogInformation("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
```

### ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®é–‹å§‹ã¨çµ‚äº†

```csharp
// èµ·å‹•æ™‚
logger.LogInformation("=== ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹• ===");

// çµ‚äº†æ™‚
logger.LogInformation("=== ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº† ===");
```

## ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ¨™æº–å½¢å¼

### æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

```csharp
logger.LogInformation("âœ“ æˆåŠŸ: {SuccessMessage}", message);
logger.LogInformation("âœ“ {TaskCount} å€‹ã®ã‚¿ã‚¹ã‚¯ã‚’ä½œæˆã—ã¾ã—ãŸ", taskCount);
logger.LogInformation("âœ“ Task {TaskId} å®Œäº†", taskId);
```

### è­¦å‘Šãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

```csharp
logger.LogWarning("âš ï¸ è­¦å‘Š: {WarningMessage}", message);
logger.LogWarning("âš ï¸ å°‚é–€å®¶ãŒé¸æŠœã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚Knowledge å°‚é–€å®¶ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ä½¿ç”¨ã—ã¾ã™ã€‚");
logger.LogWarning("âš ï¸ æœ€å¤§ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ•° ({MaxMessages}) ã«é”ã—ã¾ã—ãŸã€‚", maxMessages);
```

### ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

```csharp
logger.LogError(ex, "âŒ ã‚¨ãƒ©ãƒ¼: {ErrorMessage}", ex.Message);
logger.LogError(ex, "âŒ {ComponentName} ã‚¨ãƒ©ãƒ¼: {ErrorMessage}", componentName, ex.Message);
logger.LogError("âŒ {SpecialistName} ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ã‚¨ãƒ©ãƒ¼: {ErrorMessage}", specialistName, ex.Message);
```

### æƒ…å ±ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

```csharp
logger.LogInformation("ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ: {Endpoint}", endpoint);
logger.LogInformation("ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆå: {DeploymentName}", deployment);
logger.LogInformation("å—ä¿¡ã—ãŸè³ªå•: {Question}", question);
```

## æ§‹é€ åŒ–ãƒ­ã‚®ãƒ³ã‚°ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### æ¨å¥¨ã•ã‚Œã‚‹æ–¹æ³•

```csharp
// âœ… è‰¯ã„ä¾‹: æ§‹é€ åŒ–ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨
logger.LogInformation("ã‚¿ã‚¹ã‚¯å®Œäº†: {TaskId}, æ‹…å½“: {AssignedWorker}", taskId, worker);

// âœ… è‰¯ã„ä¾‹: è¤‡æ•°ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨
logger.LogInformation("[{MessageCount}] {AgentName} ã®ç™ºè¨€", messageCount, agentName);

// âœ… è‰¯ã„ä¾‹: ã‚¨ãƒ©ãƒ¼ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’æ¸¡ã™
logger.LogError(ex, "âŒ {ComponentName} ã‚¨ãƒ©ãƒ¼: {ErrorMessage}", componentName, ex.Message);
```

### é¿ã‘ã‚‹ã¹ãæ–¹æ³•

```csharp
// âŒ æ‚ªã„ä¾‹: æ–‡å­—åˆ—è£œé–“ã‚’ä½¿ç”¨ï¼ˆæ§‹é€ åŒ–ã•ã‚Œãªã„ï¼‰
logger.LogInformation($"ã‚¿ã‚¹ã‚¯å®Œäº†: {taskId}, æ‹…å½“: {worker}");

// âŒ æ‚ªã„ä¾‹: é€£çµã•ã‚ŒãŸæ–‡å­—åˆ—
logger.LogInformation("ã‚¿ã‚¹ã‚¯å®Œäº†: " + taskId + ", æ‹…å½“: " + worker);

// âŒ æ‚ªã„ä¾‹: Exception.ToString() ã‚’ä½¿ç”¨
logger.LogError($"ã‚¨ãƒ©ãƒ¼: {ex.ToString()}");
```

## ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆ¥ã®çµ±ä¸€ä¾‹

### SelectiveGroupChatWorkflow

```csharp
// èµ·å‹•
logger.LogInformation("=== ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³èµ·å‹• ===");
logger.LogInformation("ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªè¨­å®š: OTLP Endpoint = {OtlpEndpoint}", otlpEndpoint);

// ãƒ•ã‚§ãƒ¼ã‚º 1
logger.LogInformation("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
logger.LogInformation("ãƒ•ã‚§ãƒ¼ã‚º 1: ãƒ«ãƒ¼ã‚¿ãƒ¼ãŒå¿…è¦ãªå°‚é–€å®¶ã‚’é¸æŠœ");
logger.LogInformation("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");

// çµæœ
logger.LogInformation("âœ“ é¸æŠœã•ã‚ŒãŸå°‚é–€å®¶: {SelectedSpecialists}", string.Join(", ", specialists));
logger.LogInformation("âœ“ é¸æŠœç†ç”±: {SelectionReason}", reason);

// ã‚¨ãƒ©ãƒ¼
logger.LogError(ex, "âŒ ãƒ«ãƒ¼ã‚¿ãƒ¼å®Ÿè¡Œã‚¨ãƒ©ãƒ¼: {ErrorMessage}", ex.Message);
```

### HandoffWorkflow

```csharp
// ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼é–‹å§‹
logger.LogInformation("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
logger.LogInformation("ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œé–‹å§‹");
logger.LogInformation("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");

// ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é–‹å§‹
logger.LogInformation("[ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é–‹å§‹ #{MessageCount}] ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå: {AgentName}, ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆID: {AgentId}, ãƒ­ãƒ¼ãƒ«: {Role}", 
    messageCount, agentName, agentId, role);

// ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å®Œäº†
logger.LogInformation("[ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸å®Œäº† #{MessageCount}] ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ: {AgentId}, å†…å®¹: {Content}", 
    messageCount, agentId, content);
```

### TaskBasedWorkflow

```csharp
// ãƒ•ã‚§ãƒ¼ã‚º 1
logger.LogInformation("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
logger.LogInformation("ãƒ•ã‚§ãƒ¼ã‚º 1: Planner ãŒã‚¿ã‚¹ã‚¯è¨ˆç”»ã‚’ä½œæˆ");
logger.LogInformation("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");

// ã‚¿ã‚¹ã‚¯å®Ÿè¡Œ
logger.LogInformation("[Task {TaskId}] {TaskDescription}", taskId, description);
logger.LogInformation("æ‹…å½“: {AssignedWorker}", worker);
logger.LogInformation("å—ã‘å…¥ã‚ŒåŸºæº–: {Acceptance}", acceptance);

// å®Œäº†
logger.LogInformation("âœ“ Task {TaskId} å®Œäº†", taskId);
logger.LogInformation("å®Œäº†ç‡: {CompletedTasks}/{TotalTasks} ({CompletionRate:F1}%)", 
    completed, total, completionRate);
```

### GroupChatWorkflow

```csharp
// ã‚°ãƒ«ãƒ¼ãƒ—ãƒãƒ£ãƒƒãƒˆé–‹å§‹
logger.LogInformation("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");
logger.LogInformation("Group Chat ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼å®Ÿè¡Œé–‹å§‹");
logger.LogInformation("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");

// ç™ºè¨€é–‹å§‹
logger.LogInformation("[{MessageCount}] {AgentName} ã®ç™ºè¨€", messageCount, agentName);

// å®Œäº†
logger.LogInformation("åˆè¨ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ•°: {MessageCount}", messageCount);
```

## çµµæ–‡å­—ã®ä½¿ç”¨ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

| ç”¨é€” | çµµæ–‡å­— | ä½¿ç”¨ä¾‹ |
|-----|-------|--------|
| æˆåŠŸ | âœ“ ã¾ãŸã¯ âœ… | `âœ“ ã‚¿ã‚¹ã‚¯å®Œäº†` |
| è­¦å‘Š | âš ï¸ | `âš ï¸ ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ` |
| ã‚¨ãƒ©ãƒ¼ | âŒ | `âŒ ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ` |
| é€²è¡Œä¸­ | ğŸ”„ | `ğŸ”„ å‡¦ç†ä¸­` |
| å¾…æ©Ÿä¸­ | â³ | `â³ ã‚­ãƒ¥ãƒ¼å¾…ã¡` |
| ãƒ–ãƒ­ãƒƒã‚¯ | ğŸš« | ï¼ˆç¾åœ¨ã¯ä½¿ç”¨ã—ã¦ã„ãªã„ï¼‰ |

## åŒºåˆ‡ã‚Šè¨˜å·ã®ä½¿ç”¨ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

| ç”¨é€” | è¨˜å· | ä½¿ç”¨ä¾‹ |
|-----|------|--------|
| ãƒ¡ã‚¤ãƒ³ãƒ•ã‚§ãƒ¼ã‚º | `â”` (U+2501) | ãƒ•ã‚§ãƒ¼ã‚ºåŒºåˆ‡ã‚Š |
| ã‚µãƒ–ã‚»ã‚¯ã‚·ãƒ§ãƒ³ | `â”€` (U+2500) | ã‚°ãƒ«ãƒ¼ãƒ—ãƒãƒ£ãƒƒãƒˆã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸æ  |
| ç­‰å· | `=` | ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹/çµ‚äº† |
| ãƒã‚¤ãƒ•ãƒ³ | `-` | ã‚µãƒ–ã‚¿ã‚¹ã‚¯ã‚„ç®‡æ¡æ›¸ã |

## ã‚³ãƒ¡ãƒ³ãƒˆã®ä¸€è²«æ€§

### ã‚³ãƒ¼ãƒ‰å†…ã‚³ãƒ¡ãƒ³ãƒˆ

```csharp
// ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã‹ã‚‰å–å¾—ï¼ˆappsettings.json â†’ ç’°å¢ƒå¤‰æ•°ã®é †ã§å„ªå…ˆï¼‰
var endpoint = configuration["environmentVariables:AZURE_OPENAI_ENDPOINT"]
    ?? Environment.GetEnvironmentVariable("AZURE_OPENAI_ENDPOINT")
    ?? throw new InvalidOperationException("ç’°å¢ƒå¤‰æ•° AZURE_OPENAI_ENDPOINT ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚");

// OpenTelemetry ã¨ãƒ­ã‚®ãƒ³ã‚°ã‚’è¨­å®š
using var loggerFactory = LoggerFactory.Create(builder =>
{
    // ... è¨­å®š
});

// å°‚é–€å®¶ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ä½œæˆ
var specialists = new Dictionary<string, ChatClientAgent>
{
    ["Contract"] = CreateSpecialistAgent(extensionsAIChatClient, "Contract", "å¥‘ç´„é–¢é€£ã®å°‚é–€å®¶"),
    // ...
};
```

### ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆèª¬æ˜ã‚³ãƒ¡ãƒ³ãƒˆ

```csharp
static ChatClientAgent CreateSpecialistAgent(IChatClient chatClient, string specialty, string description)
{
    var instructions = $"""
ã‚ãªãŸã¯ {description} ã¨ã—ã¦å›ç­”ã—ã¾ã™ã€‚
å°‚é–€çŸ¥è­˜ã‚’æ´»ç”¨ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è³ªå•ã«ç­”ãˆã¦ãã ã•ã„ã€‚
ç°¡æ½”ã§å®Ÿç”¨çš„ãªå›ç­”ã‚’å¿ƒãŒã‘ã¦ãã ã•ã„ã€‚
""";

    return new ChatClientAgent(
        chatClient,
        instructions,
        $"{specialty.ToLower()}_agent",
        $"{specialty} Agent");
}
```

## æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°

ã™ã¹ã¦ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã¯ **UTF-8** ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ï¼š

```csharp
// ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã®æ–‡å­—ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’ UTF-8 ã«è¨­å®š
Console.OutputEncoding = Encoding.UTF8;
Console.InputEncoding = Encoding.UTF8;
```

## ã¾ã¨ã‚

ã“ã‚Œã‚‰ã®æ¨™æº–ã«å¾“ã†ã“ã¨ã§ï¼š

1. âœ… ã™ã¹ã¦ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ä¸€è²«ã—ãŸãƒ­ã‚°å‡ºåŠ›
2. âœ… è¦–èªæ€§ã®é«˜ã„ãƒ­ã‚°ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
3. âœ… æ§‹é€ åŒ–ã•ã‚ŒãŸãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°å¯èƒ½ãªãƒ­ã‚°
4. âœ… Aspire Dashboard ã‚„ Application Insights ã§ã®åŠ¹æœçš„ãªåˆ†æ
5. âœ… ä¿å®ˆæ€§ã®å‘ä¸Šã¨ãƒ‡ãƒãƒƒã‚°ã®åŠ¹ç‡åŒ–

è©³ç´°ãªãƒ­ã‚®ãƒ³ã‚°è¨­å®šã«ã¤ã„ã¦ã¯ [ãƒ­ã‚®ãƒ³ã‚°è¨­å®šã‚¬ã‚¤ãƒ‰](logging-setup.md) ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
